\section{Introduction}
\label{sec:intro}

%% Intro as expanded abstract, A1 -- A5
%% A1
%% There is a growing interest in the use of UML for the specification and
%% analysis of the requirements of critical systems.
%% Los problemas de los sistemas críticos 
The problems associated with the development of safety-critical
systems are well known. 
Complexity of requirements demands rigorous methodologies for the design,
verification and, of course, validation of the requirements
themselves, but this is often considered too costly to be fully 
implemented. 
%% El papel que puede jugar UML
As~\cite{juerjens_houmb_2003_dependable_computing} points out, the
consolidation of UML as a de-facto standard for industrial modeling
opened up several opportunities that were supposed to change the costs
involved in model driven development: for the first time, there was a
large base of software developers trained in a unified notation, a
reasonable number of tools to assist working with it were available
and the notation had a relatively precise definition, at least
compared to previous proposals.

%% A2
%% A key factor for the successful adoption of UML and model driven
%% methodologies is the possibility to validate designs in early stages
%% so as to correct possible mistakes or even reveal inconsistent or
%% incomplete requirements in their specifications.
%% Problems with UML
However, these opportunities did not seem to have the desired impact.
%% Explain, please (sin meternos en un jardín)
UML is mostly used as a graphical aid for sketching software designs. 
Diagrams are then used either as hints for implementation or used for
the generation of code templates, but more sophisticated uses of the
models, e.g.~for requirement validation, test-case generation or
behavioural verification fall outside of the capabilities of existing
tools and practices.
% Definitivamente, es un jardín

%% Fácil de usar => fácil de interpretar :(
The reasons for this are ultimately linked to the features that made
UML popular in the first place: the flexibility advocated by the
design of UML often results in ambiguity, as there are many elements
that can be freely combined in ways that go beyond any intended
semantics. In other words, in UML \emph{ease of use} often means
\emph{freedom to give your own interpretation}.
%% Semantics
Providing a precise semantics to UML from the beginning would have
made it smaller and less accessible to the broad audience it has
today, but that has also been the deterrent for its adoption as a
foundation for the development of methods and tools specifically
adapted to application domains in the context of safety critical
applications. 
%% Podríamos ser más específicos y atacar en detalle algunos aspectos
%% de la falta de semántica, como en el caso de los statecharts y
%% demás. 

%% DEFER THIS UNTIL RELATED WORK
%% %% Modifications and extensions to UML
%% As a reaction to the aforementioned shortcomings of UML, one
%% possibility is to propose UML-inspired notations adapted to specific
%% application domains. Extensions 

%% A3
%% One approach to achieve this goal is to translate subsets of UML into
%% formal notations that can be processed by automatic verification tools
%% such as model checkers.  However, the subsets of UML considered are
%% typically very limited and no formal definition of the translation
%% is provided. 

%% Requirement checking, by hand
As a consequence of this lack of support, when risks in a given
application domain still make formal analysis affordable (or
unavoidable), this is done basically by hand, asking some expert to
\emph{cook} the original requirements and a simplified model of the
system built, and produce a formal description that can be fed to a
theorem prover or (more likely today) a model checking tool.

%% 

%% Desventajas
This has a number of disadvantages. 
\todo{XMC: Esto casi lo tengo.}

%% A4
%% In this paper we define a formal translation of UML models containing
%% class, object and state diagrams into Uppaal
%% model checker specifications.
%% STATING THE CONTRIBUTIONS
The main contribution of this paper is a formal translation of a subset
of UML containing class, object and state diagrams into the language
managed by the Uppaal~\cite{so51010} modeling tool. Uppaal has become
quite popular thanks to its ability to model check systems with a real
time component and, indeed, that was one of the reasons that motivated its
choice as target language for our translation.

%% Detailing the contribution: Translating statecharts
In order to provide a coherent translation of UML state diagrams into
Uppaal's timed automata it was necessary to fix an \emph{idiom},
i.e.~a disciplined usage of UML constructs for defining state diagrams
that could be given a simple and precise meaning. 

We have not followed the usual practise of defining syntax and semantics
of UML by utilising the metamodeling approach combined with informal
descriptions in English. Richters \cite{ri:2002:pavumoc} identifies
what we consider important problems:
\begin{itemize}
\item You need to know the meaning of UML constructs used as a
  definition language.
\item Inconsistencies and ambiguities are introduced with the
  descriptions in natural language.
\item The boundaries between conceptual levels are not clear and very
  different relationships are represented with the same constructs.
\item OCL helps to establishing well-formedness rules but OCL also
  lacks a precise semantics.
\end{itemize}
All of this problems aggravates when you are transferring knowledge to
engineers with no previous contact with software modelling
techniques. Following a similar approach of to Richters we restricted
the UML notation to be used and gave a formal semantics based on set
theory, a common engineers' instrument.


%% Detailing the contribution 2: Translating OO features
On the other hand, Uppaal is a rather low level notation when it comes
to model complex data, at least when compared to UML. Features such as
method invocation or class inheritance, are not supported by Uppaal, so
a considerable part of the translation effort is invested in a formal
decomposition of these high-level constructs into Uppaal's simpler
elements. 

%% A5
%% The translation is applied to an industrial case study on the
%% modelling and verification of the requirements of a high-speed railway
%% signalling system. We show how errors in the model and ambiguities in
%% the requirements are automatically detected.
%% THE CASE STUDY AND WHY IT IS RELEVANT
To illustrate the translation we have used a case-study related to the
European Railway Traffic Management System
(ERTMS)~\cite{SRS:subset26:v2.3.0}. The ERTMS has as one of its
components the European Train Control System (ETCS) whose
specification provides a standard for train control systems to
guarantee the interoperability with trackside system across different
countries and manufacturers. As with other industrial specifications,
it is difficult to formalize and validate the ETCS specifications: the
specifications consists of several volumes of text written in English
and for validation, costly testing involving engineers on board of
trains performing experiments on real tracks, are currently in
place. In 2007, the European Railway Agency (ERA, \cite{web:era})
issued a call for tender for the development of a methodology,
complemented by a set of support tools, for the formalization and
validation of the ETCS specifications. The Eurailcheck project
\cite{web:eurailcheck}, originated from the succesful tenderers,
proposed the use of Rational\footnote{Rational is a trademark of IBM
  and Rational Software} tools for modelling the specifications and
validation of temporal logic properties using the NuSMV model checking
tool \cite{web:nusmv}.

Ineco-Tifsa \cite{web:ineco-tifsa} comprises a group of Spanish
state-owned companies working on improving air, rail and road
transport infrastructures. One of the tasks of their railway division
is to participate in the specification of procedures that are specific
to the Spanish railway system which must be consistent with the ETCS
specification. This task is currently done by hand by well-trained
engineers. However, within the company, there is a recognition of the
need to improve the quality of their processes and to make sure that
they follow the ETCS standard. Unfortunately, the results of the
Eurailcheck project were not directly applicable to them. On one hand
they could not cover the costs of using proprietary software like
Rational tools, on the other hand it was not clear that the
Eurailcheck tools could be easily installed and used nor that they
were still maintained. Thus, Ineco-Tifsa provided us with a case-study
which we now use as a leading example in this paper.


%% PAPER ORGANIZATION, GENTLY
%% Preliminaries
Next section provides some background on ERTMS and Uppaal, in order to
make the paper self-contained. It also contains a brief description of
the case study. Parts of it will be used as examples throughout the
paper.
%% No tengo claro que la sección 3 deba ser lo que ahora es. 
%% Secciones relativas a la traducción
The following sections develop the translation of UML models into
Uppaal in several steps.
%% UML
Section~\ref{sec:uml} defines formally the subset of UML considered for the
translation and provides a set-theoretic semantics for it.
%% Uppaal
Analogously, Section~\ref{sec:uppaal} formalizes the subset of Uppaal
used as target. 
%% Translation
The translation itself is defined in the following section.
%% Verification/Experimental results
Section~\ref{sec:verification} presents some experiments using the
case study: the Uppaal code generated from the initial UML
specification is tested by means of several queries in order to reveal
inconsistencies in the requirements.
%% Related work and Conclusion
Related work is discussed in Section~\ref{sec:related} and
Section~\ref{sec:conclusions} concludes.

